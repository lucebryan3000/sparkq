# ===================================================================
# Bootstrap Configuration - 80% Industry Standard Defaults
#
# This file contains the 80% of settings that have industry-standard
# defaults. Developers only need to answer questions for the 20% of
# settings that are truly project-specific (see bootstrap-questions.json).
#
# USAGE:
#   - Scripts read from here via config_get "section.key" "default"
#   - Run bootstrap-detect.sh to auto-detect values
#   - Edit manually to override defaults
#   - Questions in bootstrap-questions.json update values here
#
# PHILOSOPHY:
#   - 80% = Industry defaults (set once, rarely changed)
#   - 20% = Developer decisions (asked per project)
#
# Generated: 2025-12-07
# ===================================================================

# ===================================================================
# 20% - DEVELOPER DECISIONS (Asked via bootstrap-questions.json)
# These are the only values developers typically customize per project
# ===================================================================

# -------------------------------------------------------------------
# PROJECT IDENTITY (20% - Must ask)
# -------------------------------------------------------------------
[project]
name=sparkq
description=
phase=POC
owner=Bryan Luce
owner_email=bryan@appmelia.com

# -------------------------------------------------------------------
# PACKAGE MANAGER PREFERENCE (20% - Must ask)
# -------------------------------------------------------------------
[packages]
package_manager=pnpm

# -------------------------------------------------------------------
# DOCKER ENABLEMENT (20% - Must ask)
# -------------------------------------------------------------------
[docker]
enabled=true
database_type=postgres

# -------------------------------------------------------------------
# TESTING FRAMEWORK CHOICE (20% - Must ask)
# -------------------------------------------------------------------
[testing]
framework=vitest
e2e_framework=playwright

# -------------------------------------------------------------------
# HUSKY ENABLEMENT (20% - Must ask)
# -------------------------------------------------------------------
[husky]
enabled=false

# ===================================================================
# 80% - INDUSTRY STANDARD DEFAULTS (Never ask - just use these)
# ===================================================================

# -------------------------------------------------------------------
# GIT CONFIGURATION (80% defaults)
# Industry standard: main branch, auto-init repos
# -------------------------------------------------------------------
[git]
user_name=Bryan Luce
user_email=bryan@appmelia.com
default_branch=main
init_repo=true

# -------------------------------------------------------------------
# NODE.JS CONFIGURATION (80% defaults)
# Industry standard: Node 20 LTS, lock versions, install deps
# -------------------------------------------------------------------
[nodejs]
version=20
install_deps=true
lock_versions=true
save_exact=true
audit=false

# -------------------------------------------------------------------
# TYPESCRIPT CONFIGURATION (80% defaults)
# Industry standard: strict mode, ES2022, ESNext modules
# -------------------------------------------------------------------
[typescript]
enabled=true
strict=true
target=ES2022
module=ESNext
jsx=react-jsx
declaration=true
source_map=true
no_emit_on_error=true
skip_lib_check=true
es_module_interop=true
resolve_json_module=true
isolate_modules=true

# -------------------------------------------------------------------
# DOCKER DEFAULTS (80% defaults)
# Industry standard: postgres on 5432, app on 3000, redis on 6379
# -------------------------------------------------------------------
[docker_defaults]
database_name=${project.name}_dev
database_user=postgres
database_password=postgres
app_port=3000
database_port=5432
redis_port=6379
compose_project_name=${project.name}

# -------------------------------------------------------------------
# DOCKER SANDBOX (single-container app+db+redis) - 80% defaults
# Bridge networking for Codeswarm/local hosts
# -------------------------------------------------------------------
[docker_sandbox]
compose_project_name=${project.name}
app_port=3000
postgres_port=5432
redis_port=6379
postgres_user=postgres
postgres_password=postgres
postgres_db=${project.name}
mount_docker_socket=false
mount_ssh_credentials=false

# -------------------------------------------------------------------
# DOCKER DEV (single-container app+db+redis) - 80% defaults
# Balanced dev: bridge networking, non-root app user
# -------------------------------------------------------------------
[docker_dev]
compose_project_name=${project.name}
app_port=3000
debug_port=9229
postgres_port=5432
redis_port=6379
postgres_user=postgres
postgres_password=postgres
postgres_db=${project.name}
user_id=1000
group_id=1000
mount_docker_socket=false
mount_ssh_credentials=false

# -------------------------------------------------------------------
# DOCKER PROD (single-container app+db+redis) - 80% defaults
# Hardened: secrets required, non-root, read-only app FS
# -------------------------------------------------------------------
[docker_prod]
compose_project_name=${project.name}
app_port=3000
postgres_port=5432
redis_port=6379
postgres_user=${project.name}_prod
postgres_password=
postgres_db=${project.name}_prod
redis_password=
user_id=1001
group_id=1001
mount_docker_socket=false
mount_ssh_credentials=false

# -------------------------------------------------------------------
# LINTING CONFIGURATION (80% defaults)
# Industry standard: ESLint + Prettier + Stylelint enabled
# -------------------------------------------------------------------
[linting]
eslint=true
prettier=true
stylelint=true

# -------------------------------------------------------------------
# ESLINT DEFAULTS (80% defaults)
# Industry standard 2024-2025: flat config, TypeScript integration
# -------------------------------------------------------------------
[eslint]
use_flat_config=true
extends=eslint:recommended,plugin:@typescript-eslint/recommended
parser=@typescript-eslint/parser
ecma_version=latest
source_type=module
no_unused_vars=warn
no_console=warn
prefer_const=error

# -------------------------------------------------------------------
# PRETTIER DEFAULTS (80% defaults)
# Industry standard 2024-2025: consistent code formatting
# -------------------------------------------------------------------
[prettier]
single_quote=true
semi=false
tab_width=2
print_width=100
trailing_comma=all
bracket_spacing=true
arrow_parens=always
end_of_line=lf

# -------------------------------------------------------------------
# TESTING DEFAULTS (80% defaults)
# Industry standard: 80% coverage threshold
# -------------------------------------------------------------------
[testing_defaults]
coverage_threshold=80
branch_coverage=70
create_examples=true
watch_mode=false
verbose=true

# -------------------------------------------------------------------
# HUSKY DEFAULTS (80% defaults - when enabled)
# Industry standard: lint-staged + conventional commits
# -------------------------------------------------------------------
[husky_defaults]
pre_commit=lint-staged
commit_msg=commitlint
lint_staged_extensions=ts,tsx,js,jsx,json,css,scss

# -------------------------------------------------------------------
# SECURITY CONFIGURATION (80% defaults)
# Industry standard: audit enabled, moderate threshold
# -------------------------------------------------------------------
[security]
enabled=true
npm_audit=true
snyk=false
license_check=true
auto_fix=false
fail_on_critical=true
audit_level=moderate

# -------------------------------------------------------------------
# GITHUB CONFIGURATION (80% defaults)
# Industry standard: workflows + templates enabled
# -------------------------------------------------------------------
[github]
create_workflows=true
create_templates=true
branch_protection=true
ci_node_version=20

# -------------------------------------------------------------------
# DATABASE DEFAULTS (80% defaults)
# Industry standard: migrations + seeds enabled
# -------------------------------------------------------------------
[database]
create_migrations=true
create_seed=true
migration_dir=migrations
seed_dir=seeds

# -------------------------------------------------------------------
# POSTGRESQL CONFIGURATION (80% defaults)
# PostgreSQL-specific settings for database bootstrap
# -------------------------------------------------------------------
[postgres]
enabled=true                      # Enable PostgreSQL bootstrap
version=latest                    # PostgreSQL Docker image version
host=localhost                    # Database host
port=5432                         # Database port
db_name=app_db                    # Database name
db_user=postgres                  # Database user
db_password=postgres              # Database password (change in production!)
pool_size=10                      # Connection pool size
backup_enabled=true               # Enable backup script
backup_retention_days=7           # Keep backups for 7 days

# -------------------------------------------------------------------
# REDIS CONFIGURATION (80% defaults)
# Redis cache/session store configuration
# -------------------------------------------------------------------
[redis]
enabled=true                      # Enable Redis bootstrap
version=latest                    # Redis Docker image version
host=localhost                    # Redis host
port=6379                         # Redis port
password=redis_password           # Redis password (change in production!)
max_memory=256mb                  # Maximum memory (256MB for dev, 2GB+ for prod)
max_clients=10000                 # Max concurrent connections
backup_enabled=true               # Enable backup/snapshot script
backup_retention_days=30          # Keep backups for 30 days
persistence=yes                   # Enable AOF persistence

# -------------------------------------------------------------------
# MYSQL CONFIGURATION (Infrastructure - Phase 2)
# MySQL database setup for development and production
# -------------------------------------------------------------------
[mysql]
enabled=true                      # Enable MySQL bootstrap
version=8.0                        # MySQL Docker image version
host=localhost                    # MySQL host
port=3306                         # MySQL port
root_password=root                # MySQL root password (change in production!)
db_name=app_db                    # Database name
db_user=app_user                  # Application database user
db_password=app_password          # Application user password (change in production!)
charset=utf8mb4                   # Character set (UTF-8 for full Unicode support)
collation=utf8mb4_unicode_ci      # Collation
pool_size=5                       # Connection pool size for app
backup_enabled=true               # Enable backup/snapshot script
backup_retention_days=30          # Keep backups for 30 days

# -------------------------------------------------------------------
# ELASTICSEARCH CONFIGURATION (Infrastructure - Phase 2)
# Elasticsearch cluster setup for search and analytics
# -------------------------------------------------------------------
[elasticsearch]
enabled=true                      # Enable Elasticsearch bootstrap
version=8.0                        # Elasticsearch Docker image version
node_name=node-1                  # Node name
cluster_name=elasticsearch        # Cluster name
port=9200                         # Elasticsearch HTTP port
memory=512m                        # Java heap size (512MB for dev, 2GB+ for prod)
discovery_type=single-node        # single-node for dev, multinode for prod
security_enabled=false            # Disable security for dev (enable for prod!)
password=changeme                 # Elastic user password if security enabled
analysis_enabled=true             # Enable custom analyzers

# -------------------------------------------------------------------
# RATE LIMITING CONFIGURATION (Infrastructure - Phase 2)
# Redis-based rate limiting service
# -------------------------------------------------------------------
[rate_limiting]
enabled=true                      # Enable rate limiting bootstrap
redis_version=7.0                 # Redis Docker image version
redis_port=6379                   # Redis port
redis_password=                   # Redis password (auto-generated if empty)
redis_db=1                        # Redis DB number for rate limiting
strategy=token-bucket             # Rate limiting strategy: token-bucket, sliding-window, fixed-window, leaky-bucket
rate_limit_window=60              # Time window in seconds (60 = per-minute)
rate_limit_max_requests=100       # Max requests per window
rate_limit_keys_pattern=ratelimit:*  # Redis key pattern for rate limits
monitoring_enabled=true           # Enable metrics collection
metrics_port=6380                 # Metrics port

# -------------------------------------------------------------------
# EMAIL SERVICE CONFIGURATION (Infrastructure - Phase 2)
# Email service integration setup
# -------------------------------------------------------------------
[email]
enabled=true                      # Enable email service bootstrap
provider=sendgrid                 # Email provider: sendgrid, mailgun, smtp, ses
api_key=                          # API key for service (from environment)
from_address=noreply@example.com  # From address
from_name=App Notifications       # From name
template_engine=handlebars        # Template engine: handlebars, ejs
queue_enabled=true                # Enable async email queue
queue_service=redis               # Queue backend: redis, bull, rabbitmq
rate_limit=100                    # Max emails per hour
retry_enabled=true                # Enable retry on failure
retry_max_attempts=3              # Max retry attempts
retry_delay_ms=1000               # Delay between retries (ms)

# -------------------------------------------------------------------
# OAUTH2/AUTHENTICATION CONFIGURATION (Security - Phase 4)
# OAuth2 provider setup (Keycloak, Auth0, etc.)
# -------------------------------------------------------------------
[auth_oauth2]
enabled=true                      # Enable OAuth2 bootstrap
provider=keycloak                 # Provider: keycloak, auth0, okta
realm=master                      # Realm name (Keycloak) or tenant (others)
client_id=app-client              # OAuth2 client ID
client_secret=                    # Auto-generated if empty
port=8080                         # Provider port
issuer_url=                       # Generated from provider/port if empty
redirect_uris=http://localhost:3000/callback,http://localhost:3000/api/auth/callback  # Redirect URIs
scopes=openid,profile,email       # OAuth2 scopes
pkce_enabled=true                 # Enable PKCE for enhanced security
token_lifetime=3600               # Access token lifetime (seconds)

# -------------------------------------------------------------------
# VPN/NETWORK SECURITY CONFIGURATION (Security - Phase 4)
# VPN and secure networking setup
# -------------------------------------------------------------------
[network_vpn]
enabled=true                      # Enable VPN bootstrap
provider=wireguard                # VPN provider: wireguard, openvpn
protocol=wireguard                # Protocol
vpn_endpoint=vpn.example.com      # VPN endpoint
vpn_cidr=10.0.0.0/24              # VPN network CIDR
vpn_port=51820                    # VPN port (51820 for WireGuard, 1194 for OpenVPN)
vpn_interface=wg0                 # Network interface
dns_servers=8.8.8.8,8.8.4.4       # DNS servers to use
vpn_keepalive=25                  # Keepalive interval (seconds)
peers_count=5                     # Number of peer configurations to generate

# -------------------------------------------------------------------
# BACKUP & DISASTER RECOVERY CONFIGURATION (Deployment - Phase 4)
# Backup service setup with encryption and multiple backends
# -------------------------------------------------------------------
[backup]
enabled=true                      # Enable backup bootstrap
provider=restic                   # Backup tool: restic, duplicati, bacula
storage_backend=s3                # Storage: s3, local, b2, azure, gs
schedule=0 2 * * *                # Cron schedule (daily at 2 AM)
retention_days=30                 # Backup retention in days
encryption_enabled=true           # Enable encryption (mandatory for tier 3)
compression=true                  # Enable compression
compression_level=9               # Compression level (1-9)
verify_enabled=true               # Enable verification after backup
s3_bucket=app-backups             # S3 bucket name
s3_region=us-east-1               # S3 region
s3_access_key=                    # S3 access key (from environment)
s3_secret_key=                    # S3 secret key (from environment)
backup_sources=database,uploads   # Directories to backup
exclude_patterns=node_modules,*.log,tmp/**  # Patterns to exclude

# -------------------------------------------------------------------
# VSCODE CONFIGURATION (80% defaults)
# Industry standard: format on save, recommended extensions
# -------------------------------------------------------------------
[vscode]
format_on_save=true
default_formatter=esbenp.prettier-vscode
auto_fix_on_save=true
organize_imports=true

# -------------------------------------------------------------------
# EDITOR CONFIGURATION (80% defaults)
# Industry standard: 2 spaces, UTF-8, LF line endings
# -------------------------------------------------------------------
[editor]
indent_style=space
indent_size=2
charset=utf-8
end_of_line=lf
insert_final_newline=true
trim_trailing_whitespace=true

# -------------------------------------------------------------------
# PYTHON CONFIGURATION (80% defaults)
# Industry standard: Python 3.11, isolated venvs, dependency hashing
# -------------------------------------------------------------------
[python]
version=3.11
bin=python3
venv_mode=isolated
write_env=true
manage_gitignore=true
manage_claudeignore=true
install_deps=true
editable_install=false
allow_external_paths=false

# -------------------------------------------------------------------
# CLAUDE / AI CONFIGURATION (80% defaults)
# -------------------------------------------------------------------
[claude]
enable_codex=true
ai_model=sonnet
create_agents=true
create_commands=true
create_hooks=false

# -------------------------------------------------------------------
# ENVIRONMENT CONFIGURATION (80% defaults)
# -------------------------------------------------------------------
[environment]
create_env_example=true
create_envrc=true
env_file=.env
env_example_file=.env.example

# -------------------------------------------------------------------
# DOCUMENTATION & PLAYBOOK PATHS
# Dynamic paths for bootstrap system documentation
# These are relative to __bootbuild/ directory
# -------------------------------------------------------------------
[paths]
docs_dir=docs
playbooks_dir=docs/playbooks
bootstrapscripts_dir=docs/playbooks/bootstrapscripts
references_dir=docs/references
scripts_dir=scripts
templates_dir=templates
lib_dir=lib
config_dir=config

# -------------------------------------------------------------------
# PROFILES
# Predefined script combinations for different project types
# Format: profile_name=script1,script2,script3
# -------------------------------------------------------------------
[profiles]
minimal=claude,git,packages
standard=claude,git,vscode,packages,typescript,environment,linting,editor
full=claude,git,vscode,codex,packages,typescript,environment,docker,linting,editor,testing,github,security
api=claude,git,packages,typescript,environment,docker,testing,security
frontend=claude,git,vscode,packages,typescript,linting,editor,security
library=claude,git,packages,typescript,linting,testing,security
python-backend=claude,git,python,environment,docker,database,testing,security
python-cli=claude,git,python,environment,testing,security,github

# Default profile when --profile flag used without value
default_profile=standard

# -------------------------------------------------------------------
# AUTO-APPROVE SETTINGS
# Things the orchestrator can fix without asking the developer
# -------------------------------------------------------------------
[auto_approve]
# File operations
create_directories=true
create_config_files=true
backup_existing_files=true
set_file_permissions=true

# Git operations
git_init=true
create_gitignore=true
create_gitattributes=true

# Package operations
detect_package_manager=true
create_nvmrc=true
create_npmrc=true

# Validation fixes
fix_json_syntax=false
fix_yaml_syntax=false

# -------------------------------------------------------------------
# DETECTION STATUS - Project-level facts only
# Updated by bootstrap-detect.sh
# Host-level detections (git_installed, node_installed, etc.) are in:
#   __bootbuild/logs/bootstrap-detect-latest.json (not committed)
# -------------------------------------------------------------------
[detected]
last_run=12-07-2025 08:34:45 PM CST
has_package_json=false
has_git_repo=true
has_tsconfig=false
has_claude_dir=true
has_pyproject_toml=false
has_requirements_txt=false

# -------------------------------------------------------------------
# SESSION STATE
# Tracks what has been run in current session
# -------------------------------------------------------------------
[session]
scripts_run=
scripts_skipped=
scripts_failed=
last_script=
