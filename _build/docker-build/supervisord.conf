# _build/supervisord.conf
# SparkQ process manager configuration

[supervisord]
nodaemon=true
logfile=/var/log/sparkq/supervisord.log
pidfile=/var/run/supervisord.pid

[program:postgresql]
command=/usr/lib/postgresql/15/bin/postgres -D /var/lib/postgresql/data
user=postgres
autostart=true
autorestart=true
stdout_logfile=/var/log/sparkq/postgresql.log
stderr_logfile=/var/log/sparkq/postgresql.log

[program:sparkq-api]
command=tsx watch /app/src/index.ts
directory=/app
user=dev
environment=DATABASE_URL="postgresql://bootstrap:bootstrap@localhost:5432/sparkq",PORT="3000"
autostart=true
autorestart=true
startsecs=5
startretries=3
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0

[program:cron]
command=/usr/sbin/cron -f
autostart=true
autorestart=true
stdout_logfile=/var/log/sparkq/cron.log
stderr_logfile=/var/log/sparkq/cron.log
